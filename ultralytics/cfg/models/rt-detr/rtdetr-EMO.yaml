# Ultralytics YOLO ğŸš€, AGPL-3.0 license
# RT-DETR-l object detection model with P3-P5 outputs. For details see https://docs.ultralytics.com/models/rtdetr

# Parameters
nc: 80  # number of classes
scales: # model compound scaling constants, i.e. 'model=yolov8n-cls.yaml' will call yolov8-cls.yaml with scale 'n'
  # [depth, width, max_channels]
  l: [1.00, 1.00, 1024]


# æ”¯æŒä¸‹é¢çš„ç‰ˆæœ¬å‡å¯æ›¿æ¢
#  __all__ = ['EMO_1M', 'EMO_2M', 'EMO_5M', 'EMO_6M']
backbone:
  # [from, repeats, module, args]
  - [-1, 1, EMO_1M, []]  # 4


#head:
 # - [-1, 1, Conv, [256, 1, 1, None, 1, 1, False]]  # 5 input_proj.2
 # - [-1, 1, AIFI, [1024, 8]] # 6
  #- [-1, 1, Conv, [256, 1, 1]]  # 7, Y5, lateral_convs.0

  #- [-1, 1, nn.Upsample, [None, 2, 'nearest']] # 8
  #- [3, 1, Conv, [256, 1, 1, None, 1, 1, False]]  # 9 input_proj.1
  #- [[-2, -1], 1, Concat, [1]] # 10
  #- [-1, 3, RepC3, [256, 0.5]]  # 11, fpn_blocks.0
  #- [-1, 1, Conv, [256, 1, 1]]   # 12, Y4, lateral_convs.1

  #- [-1, 1, nn.Upsample, [None, 2, 'nearest']] # 13
  #- [2, 1, Conv, [256, 1, 1, None, 1, 1, False]]  # 14 input_proj.0
  #- [[-2, -1], 1, Concat, [1]]  # 15 cat backbone P4
  #- [-1, 3, RepC3, [256, 0.5]]    # X3 (16), fpn_blocks.1

 # - [-1, 1, Conv, [256, 3, 2]]   # 17, downsample_convs.0
 # - [[-1, 12], 1, Concat, [1]]  # 18 cat Y4
 # - [-1, 3, RepC3, [256, 0.5]]    # F4 (19), pan_blocks.0

 # - [-1, 1, Conv, [256, 3, 2]]   # 20, downsample_convs.1
  #- [[-1, 7], 1, Concat, [1]]  # 21 cat Y5
  #- [-1, 3, RepC3, [256, 0.5]]    # F5 (22), pan_blocks.1

  #- [[16, 19, 22], 1, RTDETRDecoder, [nc, 256, 300, 4, 8, 3]]  # Detect(P3, P4, P5)
head:
  # ç‰¹å¾æŠ•å½±å±‚ (ç»Ÿä¸€é€šé“æ•°ä¸º256)
  - [2, 1, Conv, [256, 1, 1]]  # 5: P3/8 (1/8åˆ†è¾¨ç‡)
  - [3, 1, Conv, [256, 1, 1]]  # 6: P4/16 (1/16åˆ†è¾¨ç‡)
  - [4, 1, Conv, [256, 1, 1]]  # 7: P5/32 (1/32åˆ†è¾¨ç‡)

  # æ·»åŠ AIFIåˆ°æ·±å±‚ç‰¹å¾
  - [7, 1, AIFI, [1024, 8]]  # 8: å¢å¼ºP5ç‰¹å¾ (ä¿æŒ1/32åˆ†è¾¨ç‡)

  # è‡ªä¸Šè€Œä¸‹è·¯å¾„ (P5â†’P4â†’P3)
  - [8, 1, nn.Upsample, [None, 2, 'nearest']]  # 9: P5ä¸Šé‡‡æ · (1/32â†’1/16)
  - [[9, 6], 1, Bi_FPN, []]  # 10: èåˆP5å’ŒP4 (1/16)
  - [-1, 3, RepC3, [256, 0.5]]  # 11: æ–°P4 (1/16)

  - [11, 1, nn.Upsample, [None, 2, 'nearest']]  # 12: P4ä¸Šé‡‡æ · (1/16â†’1/8)
  - [[12, 5], 1, Bi_FPN, []]  # 13: èåˆP4å’ŒP3 (1/8)
  - [-1, 3, RepC3, [256, 0.5]]  # 14: æ–°P3 (1/8)

  # è‡ªä¸‹è€Œä¸Šè·¯å¾„ (P3â†’P4â†’P5)
  - [14, 1, Conv, [256, 3, 2]]  # 15: P3ä¸‹é‡‡æ · (1/8â†’1/16)
  - [[15, 11], 1, Bi_FPN, []]  # 16: èåˆä¸‹é‡‡æ ·P3å’Œæ–°P4 (1/16)
  - [-1, 3, RepC3, [256, 0.5]]  # 17: æ›´æ–°P4 (1/16)

  - [17, 1, Conv, [256, 3, 2]]  # 18: P4ä¸‹é‡‡æ · (1/16â†’1/32)
  - [[18, 8], 1, Bi_FPN, []]  # 19: èåˆä¸‹é‡‡æ ·P4å’Œå¢å¼ºP5 (1/32)
  - [-1, 3, RepC3, [256, 0.5]]  # 20: æ›´æ–°P5 (1/32)

  # æ£€æµ‹å¤´ (ä½¿ç”¨æœ€ç»ˆæ›´æ–°åçš„ç‰¹å¾)
  - [[14, 17, 20], 1, RTDETRDecoder, [nc, 256, 300, 4, 8, 3]]  # è¾“å…¥P3(1/8), P4(1/16), P5(1/32)
